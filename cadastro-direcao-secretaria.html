<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cadastro - Direção / Secretaria</title>
<style>
body {font-family: Arial; margin:0; padding:0; background:#006400; color:#fff;}
.container {width:400px; margin:30px auto; background:#fff; color:#000; padding:20px; border-radius:10px;}
h2 {text-align:center; color:#006400;}
input, select {width:100%; margin:5px 0 10px; padding:8px; border-radius:5px; border:1px solid #ccc;}
button {background:#006400; color:#fff; border:none; padding:10px; border-radius:5px; cursor:pointer; margin-top:5px;}
button:hover {background:#008000;}
</style>
</head>
<body>
<div class="container">
<h2>Cadastro - Direção / Secretaria</h2>

<input type="text" id="nome" placeholder="Nome completo">
<input type="text" id="nomeEscola" placeholder="Nome da escola">
<select id="cargo">
  <option value="">Selecione Cargo</option>
  <option value="Direção">Direção</option>
  <option value="Secretaria">Secretaria</option>
</select>
<input type="email" id="email" placeholder="E-mail @escola.pr.gov.br">
<input type="password" id="senha" placeholder="Senha">
<button onclick="cadastrar()">Criar Conta</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.22.0/firebase-app.js";
import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/10.22.0/firebase-auth.js";
import { getFirestore, setDoc, doc } from "https://www.gstatic.com/firebasejs/10.22.0/firebase-firestore.js";

// Config Firebase
const firebaseConfig = {
  apiKey: "AIzaSyAGqD_Ni_p8eS0P4W4CBSjhIYBRE9yC4VE",
  authDomain: "ods-2b1cd.firebaseapp.com",
  projectId: "ods-2b1cd",
  storageBucket: "ods-2b1cd.appspot.com",
  messagingSenderId: "35029031501",
  appId: "1:35029031501:web:a5b47ef5c20d6fa993da04"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// CADASTRO DIREÇÃO / SECRETARIA
window.cadastrar = async function(){
  const nome = document.getElementById('nome').value;
  const nomeEscola = document.getElementById('nomeEscola').value;
  const cargo = document.getElementById('cargo').value;
  const email = document.getElementById('email').value;
  const senha = document.getElementById('senha').value;

  if(!nome || !nomeEscola || !cargo || !email || !senha){
    alert("Preencha todos os campos!");
    return;
  }

  if(cargo !== "Direção" && cargo !== "Secretaria"){
    alert("Somente cargos Direção ou Secretaria podem criar conta!");
    return;
  }

  if(!email.endsWith('@escola.pr.gov.br')){
    alert("Use um e-mail @escola.pr.gov.br");
    return;
  }

  try{
    const userCred = await createUserWithEmailAndPassword(auth,email,senha);
    await setDoc(doc(db,'usuarios',userCred.user.uid), {
      nome,
      nomeEscola,
      cargo,
      email
    });
    alert("Conta criada com sucesso!");
  }catch(e){
    alert("Erro: "+e.message);
  }
}
</script>
</body>
</html>
