<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel - Col√©gio Estadual 14 de Dezembro</title>
<style>
body {font-family: Arial, sans-serif; margin:0; padding:0; background-color:#006400; color:#fff;}
header {text-align:center; padding:20px; background-color:#004d00;}
header img {width:90px; vertical-align:middle; margin-right:10px;}
header h1 {display:inline-block; font-size:1.8em; vertical-align:middle; margin:0;}
.painel {width:90%; max-width:1000px; margin:30px auto; background:#fff; color:#000; padding:25px; border-radius:12px; box-shadow:0 0 15px rgba(0,0,0,0.3);}
h2 {text-align:center; color:#006400;}
.menu {display:flex; flex-wrap:wrap; justify-content:space-around; margin-bottom:20px;}
.menu button {background:#006400; color:#fff; border:none; border-radius:6px; padding:10px 20px; margin:5px; cursor:pointer; font-weight:bold;}
.menu button:hover {background:#008000;}
.secao {display:none; background:#f4f4f4; padding:15px; border-radius:8px; margin-top:10px;}
.ativo {display:block;}
input, textarea, select {width:100%; margin:5px 0 10px; padding:8px; border-radius:5px; border:1px solid #ccc;}
.btn {background:#006400; color:#fff; padding:8px 15px; border:none; border-radius:5px; cursor:pointer; margin-top:5px;}
.btn:hover {background:#008000;}
table {width:100%; border-collapse:collapse; margin-top:10px;}
th, td {border:1px solid #ccc; padding:8px; text-align:center;}
th {background:#006400; color:#fff;}
#logout {background:#b30000; margin-top:20px;}
#logout:hover {background:#ff0000;}
</style>
</head>
<body>

<header>
<img src="logo-colegio.png" alt="Logo Col√©gio Estadual 14 de Dezembro">
<h1>Col√©gio Estadual 14 de Dezembro - Rede Escola PR</h1>
</header>

<div class="painel">
<h2>Central de Impress√£o</h2>
<p>Usu√°rio: <span id="usuarioLogado"></span> | Cargo: <span id="cargoLogado"></span></p>

<div class="menu">
<button onclick="mostrarSecao('impressao')">üñ®Ô∏è Pedidos de Impress√£o</button>
</div>

<!-- Impress√£o -->
<div id="impressao" class="secao ativo">
<h3>Pedidos de Impress√£o</h3>
<input type="text" id="professor" placeholder="Nome do Professor">
<input type="text" id="titulo" placeholder="T√≠tulo do pedido">
<textarea id="descricao" placeholder="Descri√ß√£o do pedido"></textarea>
<input type="number" id="copias" placeholder="Quantidade de c√≥pias">
<input type="date" id="dataEntrega">
<input type="file" id="arquivo" multiple>
<button class="btn" onclick="enviarPedido()">Enviar Pedido</button>

<h4>Lista de Pedidos</h4>
<table id="tabelaPedidos">
<tr>
<th>Professor</th>
<th>T√≠tulo</th>
<th>Descri√ß√£o</th>
<th>C√≥pias</th>
<th>Data de Entrega</th>
<th>Status</th>
<th>Respons√°vel</th>
<th>Data</th>
<th>A√ß√µes</th>
</tr>
</table>
</div>

<button id="logout" class="btn" onclick="logout()">Sair</button>
</div>

<script>
// Simula√ß√£o de usu√°rio logado
let usuario = {nome:"Maria", cargo:"Respons√°vel Impress√£o"}; // altere cargo para teste: "Dire√ß√£o", "Secretaria", "Professor"
document.getElementById('usuarioLogado').innerText = usuario.nome;
document.getElementById('cargoLogado').innerText = usuario.cargo;

function mostrarSecao(id){
document.querySelectorAll('.secao').forEach(s=>s.classList.remove('ativo'));
document.getElementById(id).classList.add('ativo');
}

function enviarPedido(){
const professor = document.getElementById('professor').value;
const titulo = document.getElementById('titulo').value;
const descricao = document.getElementById('descricao').value;
const copias = document.getElementById('copias').value;
const dataEntrega = document.getElementById('dataEntrega').value;
const arquivos = Array.from(document.getElementById('arquivo').files);

if(!professor || !titulo || !descricao || !copias || !dataEntrega){
alert("Preencha todos os campos!");
return;
}

const tabela = document.getElementById('tabelaPedidos');
const tr = document.createElement('tr');
tr.files = arquivos;
tr.innerHTML = `
<td>${professor}</td>
<td>${titulo}</td>
<td>${descricao}</td>
<td>${copias}</td>
<td>${dataEntrega}</td>
<td>Pendente</td>
<td>-</td>
<td>-</td>
<td>${verBotoes()}</td>
`;
tabela.appendChild(tr);

document.getElementById('professor').value='';
document.getElementById('titulo').value='';
document.getElementById('descricao').value='';
document.getElementById('copias').value='';
document.getElementById('dataEntrega').value='';
document.getElementById('arquivo').value='';
}

function verBotoes(){
if(usuario.cargo === "Dire√ß√£o" || usuario.cargo === "Secretaria" || usuario.cargo === "Respons√°vel Impress√£o"){
return `<button onclick="aprovarPedido(this)">Aprovar</button>
        <button onclick="marcarImpresso(this)">Impresso</button>
        <button onclick="imprimirPedido(this)">Imprimir</button>`;
}
return "-";
}

function aprovarPedido(botao){
const linha = botao.parentElement.parentElement;
linha.cells[5].innerText="Aprovado";
linha.cells[6].innerText = usuario.nome;
linha.cells[7].innerText = new Date().toLocaleString();
}

function marcarImpresso(botao){
const linha = botao.parentElement.parentElement;
linha.cells[5].innerText="Impresso";
linha.cells[6].innerText = usuario.nome;
linha.cells[7].innerText = new Date().toLocaleString();
}

function imprimirPedido(botao){
const linha = botao.parentElement.parentElement;
const arquivos = linha.files;
const janela = window.open('','_blank','width=800,height=600');
let conteudo = `<h2>Pedido de Impress√£o</h2>
<p><strong>Professor:</strong> ${linha.cells[0].innerText}</p>
<p><strong>T√≠tulo:</strong> ${linha.cells[1].innerText}</p>
<p><strong>Descri√ß√£o:</strong> ${linha.cells[2].innerText}</p>
<p><strong>C√≥pias:</strong> ${linha.cells[3].innerText}</p>
<p><strong>Data de Entrega:</strong> ${linha.cells[4].innerText}</p>
<p><strong>Status:</strong> ${linha.cells[5].innerText}</p>
<p><strong>Respons√°vel:</strong> ${linha.cells[6].innerText}</p>
<p><strong>Data:</strong> ${linha.cells[7].innerText}</p>
<h3>Arquivos:</h3>`;

if(arquivos.length>0){
arquivos.forEach((file,index)=>{
if(file.type.startsWith("image/")){
const reader = new FileReader();
reader.onload=function(e){
conteudo += `<img src="${e.target.result}" style="max-width:100%;margin-top:10px;">`;
if(index === arquivos.length-1){janela.document.write('<html><head><title>Imprimir</title></head><body>'+conteudo+'</body></html>'); janela.document.close(); janela.print();}
}
reader.readAsDataURL(file);
}else if(file.type==="application/pdf"){
conteudo += `<embed src="${URL.createObjectURL(file)}" type="application/pdf" width="100%" height="500px" style="margin-top:10px;">`;
if(index === arquivos.length-1){janela.document.write('<html><head><title>Imprimir</title></head><body>'+conteudo+'</body></html>'); janela.document.close(); janela.print();}
}else{
conteudo += `<p><a href="${URL.createObjectURL(file)}" target="_blank">${file.name}</a></p>`;
if(index === arquivos.length-1){janela.document.write('<html><head><title>Imprimir</title></head><body>'+conteudo+'</body></html>'); janela.document.close(); janela.print();}
}
});
}else{
janela.document.write('<html><head><title>Imprimir</title></head><body>'+conteudo+'<p>Nenhum arquivo enviado</p></body></html>'); 
janela.document.close(); janela.print();
}
}

function logout(){alert("Logout efetuado!");}
</script>
</body>
</html>
