<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Painel - Col√©gio Estadual</title>
<style>
body {font-family: Arial, sans-serif; margin:0; padding:0; background-color:#006400; color:#fff;}
header {text-align:center; padding:20px; background-color:#004d00;}
header h1 {margin:0; font-size:1.8em;}
.painel {width:90%; max-width:1000px; margin:20px auto; background:#fff; color:#000; padding:20px; border-radius:12px; box-shadow:0 0 15px rgba(0,0,0,0.3);}
h2 {text-align:center; color:#006400;}
.menu {display:flex; flex-wrap:wrap; justify-content:space-around; margin-bottom:20px;}
.menu button {background:#006400; color:#fff; border:none; border-radius:6px; padding:10px 20px; margin:5px; cursor:pointer; font-weight:bold;}
.menu button:hover {background:#008000;}
.secao {display:none; background:#f4f4f4; padding:15px; border-radius:8px; margin-top:10px;}
.ativo {display:block;}
input, textarea, select {width:100%; margin:5px 0 10px; padding:8px; border-radius:5px; border:1px solid #ccc;}
.btn {background:#006400; color:#fff; padding:8px 15px; border:none; border-radius:5px; cursor:pointer; margin-top:5px;}
.btn:hover {background:#008000;}
table {width:100%; border-collapse:collapse; margin-top:10px;}
th, td {border:1px solid #ccc; padding:8px; text-align:center;}
th {background:#006400; color:#fff;}
#logout {background:#b30000; margin-top:20px;}
#logout:hover {background:#ff0000;}
</style>
</head>
<body>
<header>
<h1>Col√©gio Estadual - Painel Administrativo</h1>
</header>

<div class="painel">
<h2>Central de Administra√ß√£o Escolar</h2>

<div class="menu">
<button onclick="mostrarSecao('impressao')">üñ®Ô∏è Pedidos de Impress√£o</button>
<button onclick="mostrarSecao('comunicados')">üì¢ Comunicados</button>
<button onclick="mostrarSecao('mensagens')">üí¨ Mensagens</button>
<button onclick="mostrarSecao('agenda')">üìÖ Agenda Escolar</button>
<button onclick="mostrarSecao('biblioteca')">üìö Biblioteca Digital</button>
<button onclick="mostrarSecao('financeiro')">üí∞ Financeiro</button>
<button onclick="mostrarSecao('config')">‚öôÔ∏è Configura√ß√µes</button>
</div>

<!-- Impress√£o -->
<div id="impressao" class="secao ativo">
<h3>Pedidos de Impress√£o</h3>
<input type="text" id="titulo" placeholder="T√≠tulo do pedido">
<textarea id="descricao" placeholder="Descri√ß√£o do pedido"></textarea>
<input type="file" id="arquivo" multiple>
<button class="btn" onclick="enviarPedido()">Enviar Pedido</button>

<h4>Lista de Pedidos</h4>
<table id="tabelaPedidos">
<tr>
<th>T√≠tulo</th><th>Descri√ß√£o</th><th>Status</th><th>Respons√°vel</th><th>Data</th><th>A√ß√µes</th>
</tr>
</table>
</div>

<!-- Comunicados -->
<div id="comunicados" class="secao">
<h3>Comunicados</h3>
<div id="listaComunicados"></div>
</div>

<!-- Mensagens -->
<div id="mensagens" class="secao">
<h3>Mensagens Internas</h3>
<textarea id="msgTexto" placeholder="Digite uma mensagem..."></textarea>
<button class="btn" onclick="enviarMensagem()">Enviar</button>
<div id="historicoMensagens"></div>
</div>

<!-- Agenda -->
<div id="agenda" class="secao"><h3>Agenda Escolar</h3><div id="calendario"></div></div>

<!-- Biblioteca -->
<div id="biblioteca" class="secao"><h3>Biblioteca Digital</h3><div id="listaMateriais"></div></div>

<!-- Financeiro -->
<div id="financeiro" class="secao"><h3>Financeiro</h3><div id="dadosFinanceiro"></div></div>

<!-- Configura√ß√µes -->
<div id="config" class="secao"><h3>Configura√ß√µes</h3></div>

<button id="logout" class="btn" onclick="logout()">Sair</button>
</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/10.22.0/firebase-app.js";
import { getAuth, signOut } from "https://www.gstatic.com/firebasejs/10.22.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, serverTimestamp } from "https://www.gstatic.com/firebasejs/10.22.0/firebase-firestore.js";

// Config Firebase
const firebaseConfig = {
  apiKey: "AIzaSyAGqD_Ni_p8eS0P4W4CBSjhIYBRE9yC4VE",
  authDomain: "ods-2b1cd.firebaseapp.com",
  projectId: "ods-2b1cd",
  storageBucket: "ods-2b1cd.appspot.com",
  messagingSenderId: "35029031501",
  appId: "1:35029031501:web:a5b47ef5c20d6fa993da04"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Mostrar se√ß√µes
function mostrarSecao(id){ document.querySelectorAll('.secao').forEach(s=>s.classList.remove('ativo')); document.getElementById(id).classList.add('ativo'); }

// Logout
window.logout = function(){ signOut(auth).then(()=>window.location.href="index.html"); }

// Pedidos de impress√£o
window.enviarPedido = async function(){
  const titulo=document.getElementById('titulo').value;
  const descricao=document.getElementById('descricao').value;
  const arquivos=document.getElementById('arquivo').files;
  if(!titulo || !descricao){ alert("Preencha t√≠tulo e descri√ß√£o"); return; }

  try{
    const docRef = await addDoc(collection(db,'pedidos'), {
      titulo, descricao, status:'Pendente', responsavel:'Dire√ß√£o/Secretaria', data: serverTimestamp()
    });
    alert("Pedido enviado!");
    document.getElementById('titulo').value=''; document.getElementById('descricao').value=''; document.getElementById('arquivo').value='';
    carregarPedidos();
  }catch(e){ alert("Erro: "+e.message); }
}

// Carregar pedidos
async function carregarPedidos(){
  const tabela = document.getElementById('tabelaPedidos');
  tabela.innerHTML=`<tr>
<th>T√≠tulo</th><th>Descri√ß√£o</th><th>Status</th><th>Respons√°vel</th><th>Data</th><th>A√ß√µes</th>
</tr>`;
  const querySnapshot = await getDocs(collection(db,'pedidos'));
  querySnapshot.forEach(docu=>{
    const data = docu.data();
    const tr = document.createElement('tr');
    tr.innerHTML=`<td>${data.titulo}</td><td>${data.descricao}</td><td>${data.status}</td><td>${data.responsavel}</td><td>${data.data?.toDate().toLocaleString() || ''}</td>
    <td>
      <button onclick="aprovarPedido(this)">Aprovar</button>
      <button onclick="marcarImpresso(this)">Impresso</button>
    </td>`;
    tabela.appendChild(tr);
  });
}
window.onload = carregarPedidos;

// Fun√ß√µes aprovar e marcar impresso
window.aprovarPedido = function(btn){ btn.parentElement.parentElement.cells[2].innerText="Aprovado"; }
window.marcarImpresso = function(btn){ btn.parentElement.parentElement.cells[2].innerText="Impresso"; }
</script>
</body>
</html>
